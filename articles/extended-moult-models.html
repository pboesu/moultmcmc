<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Extended moult models • moultmcmc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Extended moult models">
<meta property="og:description" content="moultmcmc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">moultmcmc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/extended-moult-models.html">Extended moult models</a>
    </li>
    <li>
      <a href="../articles/getting-started.html">Getting started with moultmcmc</a>
    </li>
    <li>
      <a href="../articles/moult-likelihoods.html">Moult data likelihoods and model priors</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="extended-moult-models_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Extended moult models</h1>
            
      
      
      <div class="hidden name"><code>extended-moult-models.Rmd</code></div>

    </div>

    
    
<p>To install <code>moultmcmc</code> please follow the instructions in the <a href="https://github.com/pboesu/moultmcmc#installation" class="external-link">README file</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">moult</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">moultmcmc</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstan/" class="external-link">rstan</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="lumped-models">Lumped models<a class="anchor" aria-label="anchor" href="#lumped-models"></a>
</h2>
</div>
<div class="section level2">
<h2 id="mixed-moult-data">Mixed moult data<a class="anchor" aria-label="anchor" href="#mixed-moult-data"></a>
</h2>
</div>
<div class="section level2">
<h2 id="repeated-measures-moult-models">Repeated measures moult models<a class="anchor" aria-label="anchor" href="#repeated-measures-moult-models"></a>
</h2>
<p>When the assumption of even sampling among and within moult categories is violated, the standard moult model can converge at biologically non-sensible results.</p>
<p>This problem can be greatly reduced when information about the pace of moult from within-season recaptures of individuals is explicitly incorporated into to the parameter estimation using the model.</p>
<p>The repeated measures model is currently implemented for data types 2, 3 and 5 in the <code>moultmcmc</code> function. The repeated measures model is triggered by supplying the optional argument <code>id_column</code> which designates <em>within season</em> recaptures, typically formed of a combination of ring number and season.</p>
<p>We demonstrate this here using a citizen science dataset of moult scores from Eurasian Siskins (<em>Spinus spinus</em>) which is biased towards records of birds in the early stages of moult (<span class="citation">Insley, Beck, and Boersch-Supan (n.d.)</span>).</p>
<div class="figure">
<img src="extended-moult-models_files/figure-html/siskin-hist-1.png" alt="Frequency distribution of moult records with respect to moult progress for actively moulting Eurasian Siskins [@insley2022moult] sampled in a sub-urban garden in Scotland (left) and seasonal progression of observed moult scores from the same dataset (right). Lines connect repeated observations of the same individuals." width="672"><p class="caption">
Frequency distribution of moult records with respect to moult progress for actively moulting Eurasian Siskins <span class="citation">(Insley, Beck, and Boersch-Supan, n.d.)</span> sampled in a sub-urban garden in Scotland (left) and seasonal progression of observed moult scores from the same dataset (right). Lines connect repeated observations of the same individuals.
</p>
</div>
<p>The standard models are fitted using the <code>moult</code> package</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#fit standard Underhill-Zucchini models</span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/moult/man/moult.html" class="external-link">moult</a></span><span class="op">(</span><span class="va">pfmg</span> <span class="op">~</span> <span class="va">yday</span>, data <span class="op">=</span> <span class="va">siskins</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">m5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/moult/man/moult.html" class="external-link">moult</a></span><span class="op">(</span><span class="va">pfmg</span> <span class="op">~</span> <span class="va">yday</span>, data <span class="op">=</span> <span class="va">siskins</span>, type <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>and the repeated measures models with <code>moultmcmc</code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#fit the equivalent recapture model</span></span>
<span><span class="va">uz3_recap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moultmcmc.html">moultmcmc</a></span><span class="op">(</span>moult_column <span class="op">=</span> <span class="st">'pfmg'</span>,</span>
<span>                       date_column <span class="op">=</span> <span class="st">'yday'</span>,</span>
<span>                       id_column <span class="op">=</span> <span class="st">'id'</span>,</span>
<span>                       start_formula <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>                       duration_formula <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>                       type <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                       log_lik <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                       data<span class="op">=</span><span class="va">siskins</span>,</span>
<span>                       iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                       chain <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                       cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stanfit-class.html" class="external-link">get_elapsed_time</a></span><span class="op">(</span><span class="va">uz3_recap</span><span class="op">$</span><span class="va">stanfit</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 65.647</span></span>
<span><span class="va">uz5_recap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moultmcmc.html">moultmcmc</a></span><span class="op">(</span><span class="st">'pfmg'</span>,</span>
<span>                       <span class="st">'yday'</span>,</span>
<span>                       <span class="st">'id'</span>,</span>
<span>                       start_formula <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>                       duration_formula <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>                       type <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                       log_lik <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                       data<span class="op">=</span><span class="va">siskins</span>,</span>
<span>                       iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                       chain <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                       cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stanfit-class.html" class="external-link">get_elapsed_time</a></span><span class="op">(</span><span class="va">uz5_recap</span><span class="op">$</span><span class="va">stanfit</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 106.517</span></span></code></pre></div>
<p>When comparing the results visually it is apparent that the moult period for the population predicted by the standard models fails to encapsulate a substantial proportion of the observed data (Fig. @ref(fig:siskin-model-plots)), whereas this is not the case for the repeated measures models.</p>
<div class="figure">
<img src="extended-moult-models_files/figure-html/siskin-model-plots-1.png" alt="Standard type 3 and 5 moult models fitted to the Siskin dataset without considering within-season recaptures converge at biased parameter estimates (red lines and polygons). When recapture information is included in the model, the resulting fits (green lines and polygons) better encapsulate the observed data." width="672"><p class="caption">
Standard type 3 and 5 moult models fitted to the Siskin dataset without considering within-season recaptures converge at biased parameter estimates (red lines and polygons). When recapture information is included in the model, the resulting fits (green lines and polygons) better encapsulate the observed data.
</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-insley2022moult">
<p>Insley, Hugh, Samantha Beck, and Philipp Boersch-Supan. n.d. “Breeding and moult phenology of siskins in the Scottish Highlands.”</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Philipp Boersch-Supan.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
